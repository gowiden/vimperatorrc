" VIMPERATOR CONFIGURATION
" File: ~/.vimperatorrc
" Source: github
" Author: Todd <https://about.me/vimer>
" Sources used: https://github.com/gowiden/vimperatorrc/blob/master/vimperatorrc

source! /home/Todd/.vimperatorrc.local

" title bar
set titlestring="Iceweasel Vimperator"

" surround com and net -> <CTRL>+<ENTER> -> .com/.net
cnoremap<S-Return> <End>.org<Home><C-Right>www.<CR>
cnoremap<C-Return> <End>.com<Home><C-Right>www.<CR>

set hintchars=abcdefghijklmnopqrstuvwxyz

" hide nav-bar
set gui=nonavigation

set suggestengines=''

set wildmode=list:full

set animations

" colorscheme
colorscheme indigo

" normal-mode
set focuscontent

" a max number of listing items
set maxitems=6

" tab operation
noremap q gT
noremap w gt

" finish
echo "hello world!"

" y ~ Y,Y ~ y
noremap y Y
noremap Y y

" I don't like beeps
set visualbell
" useful for command-line completion
set autocomplete
set wildmode=list:longest,full

" automatic pass-through mode on certain pages (do ':h autocommands' for details)
autocmd LocationChange .* :js modes.passAllKeys = /gmail\.com/.test(buffer.URL)

" you can even add new functions which are then available to the :js command
js <<EOF
    toggle_element = function (name) {
        document.getElementById(name).collapsed ^= 1;
    }
EOF
" and now use it in mappings (':h key-notation'):
" show tabbar only
set gui=none,tabs,addons
"map <F2> :set gui=invmenu<Return>
"map <F3> :set gui=invnavigation<Return>
"map <F4> :set gui=invaddons<Return>
map <silent> <F2> :js<Space>toggle_element('toolbar-menubar')<Return>
map <silent> <F3> :js<Space>toggle_element('nav-bar')<Return>

" vim external editor
set editor=gvim\ -f
set editor=urxvt\ -e\ vim

" hint, disables fcitx
nnoremap <silent> f :silent !fcitx-remote -c<CR>f
nnoremap <silent> F :silent !fcitx-remote -c<CR>F
nnoremap <silent> : :silent !fcitx-remote -c<CR>:

" shortcuts ppen URL
noremap tw :tabopen https://wx.qq.com<CR>
noremap tv :tabopen https://about.me/vimer<CR>
noremap ta :tabopen https://appengine.google.com/<CR>
noremap tm :tabopen https://mail.google.com/<CR>
noremap tg :tabopen https://plus.google.com/<CR>
noremap tq :tabopen https://groups.google.com/<CR>
noremap tp :tabopen https://picasaweb.google.com/<CR>
noremap tb :tabopen https://pan.baidu.com<CR>
noremap tl :tabopen outlook.com<CR>
noremap tr :tabopen https://translate.google.com/#auto/zh-CN/<CR>
noremap ts :tabopen https://www.google.com/ncr<CR>

" on / off flashplayer
javascript <<EOM
function toggle_flash() {
  var oldvar = options.getPref('plugin.state.flash');
  if (oldvar > 0)
    liberator.echo('flash-plugin disabled.');
  else
    liberator.echo('flash-plugin enabled.');
  options.setPref('plugin.state.flash', 2-oldvar);
}
EOM

command! flashtoggle :js toggle_flash()
nnoremap <C-F> :flashtoggle<CR>

"autocmd flashplayer
javascript <<EOM
function execute_if_no_flash(command) {
  if (options.getPref('plugin.state.flash') == 0)
    liberator.execute(command);
}
EOM

command! youplayer :openwith youplayer
command! bilidan :openwith bilidan
autocmd PageLoad v\\.youku\\.com js execute_if_no_flash('youplayer')
autocmd PageLoad www\\.bilibili\\.com/video/av js execute_if_no_flash('bilidan')

" autocmd google inbox
" @see https://gist.github.com/VictorBjelkholm/1d0f4ee6dc5ec0d6646e
javascript <<EOM
function inbox_enable() {
  options.setPref('general.useragent.override',
    'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 ' +
    '(KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36');
  options.setPref('security.csp.enable', false);
}

function restore_from_inbox() {
 options.resetPref('general.useragent.override');
 options.setPref('security.csp.enable', true);
}
EOM

autocmd LocationChange .* js restore_from_inbox()
autocmd LocationChange inbox\\.google\\.com js inbox_enable()

" on / off foxyproxy
let autochanger_proxy_settings = "[{ name:'disable', usage: 'direct connection', proxy:{type:0} },{ name:'socks', usage: 'ssh tunnel', proxy:{type:1,socks:'localhost',socks_port:9999,no_proxies_on:'localhost,127.0.0.1',}}]"

let autochanger_proxy_enabled="true"

nnoremap <C-A-p> :proxy socks<CR>
nnoremap <C-A-d> :proxy disable<CR>


" vim: set ft=vimperator:
